# Google Photo Takeout Organizer

Google Photo Takeout Organizer は、Google Takeout からエクスポートされた写真や動画ファイルを、撮影日時に基づいて自動的に整理し、年/月ごとのフォルダ構造にコピーするツールです。これにより、膨大な量のメディアファイルを効率的に管理し、アクセスしやすくすることができます。

---

## ✨ 特徴

* **元のデータを保護**: 整理はファイルのコピーによって行われるため、元の Google Takeout データは変更されず、安全に保たれます。
* **包括的な処理**: Google Takeout のGooleフォトのフォルダ（例：C:￥Download\takeout-XXX\Takeout\Googleフォト）直下にある全てのフォルダ（既存の年フォルダを含む）と、ルート直下のメディアファイルを整理対象とします。
* **賢い日時特定**:
    * **Google Photos JSON メタデータ**を最優先で参照し、正確な撮影日時を取得します。
    * JSON ファイルが見つからない、または日時情報が不完全な場合は、画像ファイル内の **EXIF 情報**から撮影日時を抽出します。
    * いずれの情報も見つからない場合は、ファイルの**最終更新日時（ファイルシステムの日時）**を代替として使用します。
* **「dateunknown」フォルダへの振り分け**: 取得した日時が**Google フォトのサービス開始（2015年5月28日）よりも古いファイル、未来の日時のファイル、または日時が特定できなかったファイル**は、自動的に `dateunknown` という専用フォルダに整理されるため、古いデータや整理が難しいファイルを別途確認できます。
* **詳細なログ出力**: 処理の進行状況、コピーされたファイル、スキップされたファイル、エラーなどの詳細が、出力先フォルダ内に自動で生成されるログファイルに記録されます。これにより、後から処理内容を正確に確認でき、万が一のトラブルシューティングに役立ちます。
* **日本語対応**: Tkinter を利用した直感的な GUI とメッセージは全て日本語で表示され、日本のユーザーにとって使いやすくなっています。

---

## 🚀 GooglePhotoTakeoutHelper との違い・改良点

このツールは、既存の GooglePhotoTakeoutHelper のコンセプトを基にしつつ、特に以下の点で改良を加えています。

* **EXIF 情報のサポート**: 画像ファイルに埋め込まれた EXIF (Exchangeable image file format) 情報から直接撮影日時を読み取る機能を追加しました。これにより、JSON ファイルが存在しない場合でも、より正確な撮影日時での整理が可能になります。
* **ログ出力の強化と一元化**: 処理の詳細をコンソールに加え、出力先のフォルダ内にログファイル（`google_takeout_organizer.log`）として保存するようにしました。これにより、GUI で操作するユーザーも、処理完了後に詳細な結果を確認しやすくなりました。
* **柔軟な日時判定**: 「Google フォトのサービス開始日（2015年5月28日）」を基準に導入し、この範囲外のファイルや日時不明なファイルを `dateunknown` フォルダに集約することで、大量のファイルをより効率的に整理・確認できるようになりました。

---

## ⚙️ 使い方

### EXE ファイルを使用する場合 (Windows 専用)

1.  GitHubのリリースセクションから最新の `GooglePhotoTakeoutOrganizer.exe` をダウンロードします。
2.  ダウンロードした EXE ファイルをダブルクリックして実行します。
3.  画面の指示に従って、Google Takeout の元のデータが入っているルートフォルダと、整理後のファイルを出力する新しいフォルダを選択してください。

### ソースコードから実行する場合 (Windows 以外のOS / 開発者向け)

Python がインストールされている環境であれば、OS を問わずこの方法で実行できます。

1.  Python 3.x がインストールされていることを確認してください。
2.  **必須ライブラリ Pillow のインストール**: コマンドプロンプトまたはターミナルを開き、以下のコマンドを実行して必要なライブラリをインストールします。EXIF 情報からの日時取得に必要です。

    ```bash
    pip install Pillow
    ```
3.  このスクリプトファイル（例: `google_takeout_organizer.py`）をダウンロードします。
4.  コマンドプロンプトまたはターミナルを開き、スクリプトがあるディレクトリに移動します。
5.  以下のコマンドでスクリプトを実行します。

    ```bash
    python google_takeout_organizer.py
    ```
6.  画面の指示に従って、Google Takeout の元のデータが入っているルートフォルダと、整理後のファイルを出力する新しいフォルダを選択してください。

**出力フォルダの構成例:**

例えば、出力先フォルダとして `C:\MyOrganizedPhotos` を選択した場合、ファイルは以下のような構造でコピーされます。


```
C:\MyOrganizedPhotos
├── 2023
│ ├── 01
│ │ └── photo_20230115_1.jpg
│ ├── 02
│ │ └── video_20230220.mp4
│ └── 10
│ └── image_20231005.png
├── 2024
│ ├── 03
│ │ └── img_20240301.jpg
│ └── 04
│ └── movie_20240410.mov
└── dateunknown
　├── old_photo_1998.jpg
　└── no_date_video.mp4
```
---

## 📄 ログファイルの読み方

処理が完了すると、選択した出力先フォルダの直下に `google_takeout_organizer.log` という名前のログファイルが作成されます。このファイルには、スクリプトの実行に関する詳細な情報が記録されており、処理の確認やトラブルシューティングに役立ちます。

ログファイルのエントリは、基本的に以下の形式で出力されます。



YYYY-MM-DD HH:MM:SS,ms - LEVEL - MESSAGE

各要素の意味は以下の通りです。

* `YYYY-MM-DD HH:MM:SS,ms`: ログが出力された日時（年-月-日 時:分:秒,ミリ秒）。
* `LEVEL`: ログの種類を示します。
    * `INFO`: 通常の情報メッセージ。処理の進捗や、ファイルが正常に処理されたことなどを示します。
        * 例: `コピー成功: 'IMG_1234.JPG' -> 'C:\Output\2023\10\IMG_1234.JPG' (日時設定済み)`
        * 例: `JSONから日時取得: 'video.mp4' -> 2023/11/05 10:30:00 JST+0900`
        * 例: `[スキップ] 'duplicate.jpg' は既に移動先に存在し、内容も同じと判断しました。`
    * `WARNING`: 警告メッセージ。処理は続行できますが、何らかの問題が発生した可能性を示します。
        * 例: `[警告] JSONファイル 'photo.jpg.json' の解析に失敗しました: ...`
        * 例: `[警告] EXIF情報からの日時取得に失敗しました 'corrupted.jpg': ...`
        * 例: `[警告] 未知のタイムゾーン 'PDT' が検出されました。UTCとして処理します。`
    * `ERROR`: エラーメッセージ。特定のファイルの処理に失敗したことを示します。
        * 例: `[エラー] コピー失敗 'file.png' -> 'C:\Output\2024\01': [Errno 13] Permission denied`
        * 例: `[エラー] ファイルシステムの日時取得にも失敗しました 'no_access.mov': ...`
    * `CRITICAL`: 致命的なエラーメッセージ。スクリプトの実行が続行できないような重大な問題が発生した場合に表示されます。
* `MESSAGE`: 具体的なログの内容。何が起こったのか、どのファイルが関係しているかなどが記述されます。

ログファイルを確認することで、どのファイルがどの方法で日時が特定され、どこにコピーされたか、あるいはなぜスキップされたり失敗したりしたかなどを把握できます。

---

## ⚠️ 注意事項

* このツールはファイルのコピーを行い、元の Google Takeout データは変更しませんが、万が一に備えて重要なデータは事前にバックアップを取ることをお勧めします。
* **動画ファイルには EXIF 情報が基本的に含まれていません。** そのため、JSON 情報が見つからない動画ファイルの場合は、ファイルシステムの最終更新日時が整理基準として使用される可能性が高くなります。
* **Google フォトが撮影日時を認識できなかったファイル（例: アップロード時に日時情報が失われたファイル）の場合、そのファイルの JSON メタデータには、Google フォトにアップロードされた日時（多くの場合、Google Takeout のダウンロードを開始した日や Takeout ファイルが生成された日時に近い）が記録されます。** この日時がGoogleフォトのサービス開始日（2015年5月28日）以降であれば、`dateunknown`フォルダには整理されませんが、**元の正確な撮影日時とは異なるため、意図しない年/月フォルダに整理される可能性があります。**
* ログファイル（`google_takeout_organizer.log`）は、出力先フォルダの直下に作成されます。処理の進行状況やエラーの詳細は、このファイルをテキストエディタで開いてご確認ください。


